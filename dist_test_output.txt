initialize network with normal
initialize network with normal
initialize network with normal
initialize network with normal
Start Profiling!
Outputting memory timeline
metrics table:
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         2.76%     167.455ms         2.83%     171.586ms       6.755us       0.000us         0.00%       0.000us       0.000us       7.50 Mb       7.50 Mb      55.49 Gb      55.49 Gb         25400  
                                    aten::empty_strided         0.94%      57.194ms         0.96%      58.139ms       7.305us       0.000us         0.00%       0.000us       0.000us      60.00 Mb      60.00 Mb      28.93 Gb      28.93 Gb          7959  
                             aten::convolution_backward         4.21%     255.652ms         9.58%     581.945ms     167.226us        1.137s        50.18%        1.188s     341.387us           0 b           0 b      23.15 Gb      16.36 Gb          3480  
                                aten::cudnn_convolution         2.45%     149.024ms         3.95%     239.822ms      74.019us     370.648ms        16.35%     371.218ms     114.574us           0 b           0 b      12.91 Gb      12.91 Gb          3240  
                                          aten::resize_         0.25%      15.196ms         0.27%      16.346ms       6.287us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      11.10 Gb      11.10 Gb          2600  
                               aten::threshold_backward         0.34%      20.735ms         0.57%      34.512ms      20.543us      45.315ms         2.00%      45.315ms      26.973us           0 b           0 b      10.39 Gb      10.39 Gb          1680  
                                              aten::add         0.34%      20.608ms         0.51%      31.031ms      22.486us      19.454ms         0.86%      19.454ms      14.097us           0 b           0 b       4.72 Gb       4.72 Gb          1380  
                      aten::cudnn_convolution_transpose         0.17%      10.577ms         0.32%      19.418ms      80.910us      35.157ms         1.55%      35.157ms     146.488us           0 b           0 b       2.81 Gb       2.81 Gb           240  
                              aten::leaky_relu_backward         0.10%       6.120ms         0.16%       9.673ms      20.152us       3.963ms         0.17%       3.963ms       8.256us           0 b           0 b       1.11 Gb       1.11 Gb           480  
                                             aten::tanh         0.04%       2.509ms         0.06%       3.618ms      30.150us     303.103us         0.01%     303.103us       2.526us           0 b           0 b      90.00 Mb      90.00 Mb           120  
                                    aten::tanh_backward         0.03%       1.902ms         0.05%       3.199ms      26.661us     423.741us         0.02%     423.741us       3.531us           0 b           0 b      90.00 Mb      90.00 Mb           120  
                                              aten::mul         0.09%       5.548ms         0.14%       8.697ms      21.742us     596.768us         0.03%     596.768us       1.492us           0 b           0 b      60.16 Mb      60.16 Mb           400  
                                              aten::div         0.09%       5.500ms         0.11%       6.558ms      54.651us     188.965us         0.01%     188.965us       1.575us      30.00 Mb      30.00 Mb      60.00 Mb      60.00 Mb           120  
                                              aten::sub         0.02%       1.350ms         0.03%       2.033ms      25.414us     254.975us         0.01%     254.975us       3.187us           0 b           0 b      60.00 Mb      60.00 Mb            80  
                                              aten::sgn         0.02%     988.585us         0.03%       1.631ms      20.389us     189.986us         0.01%     189.986us       2.375us           0 b           0 b      60.00 Mb      60.00 Mb            80  
                                              aten::cat         0.02%       1.031ms         0.03%       1.531ms      38.286us     133.053us         0.01%     133.053us       3.326us           0 b           0 b      30.00 Mb      30.00 Mb            40  
                                     aten::_convolution         0.75%      45.418ms         6.25%     379.505ms     109.053us       0.000us         0.00%     445.985ms     128.157us           0 b           0 b      15.72 Gb       9.13 Mb          3480  
                                              aten::sum         1.10%      66.543ms         1.58%      96.101ms      29.299us      50.738ms         2.24%      50.738ms      15.469us           0 b           0 b       2.87 Mb       2.87 Mb          3280  
                                             aten::mean         0.09%       5.312ms         0.13%       7.635ms      38.173us     815.764us         0.04%     815.764us       4.079us           0 b           0 b      40.00 Kb      40.00 Kb           200  
void cudnn::engines_precompiled::nhwcToNchwKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us      75.295ms         3.32%      75.295ms      11.355us           0 b           0 b           0 b           0 b          6631  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      50.877ms         2.24%      50.877ms      15.417us           0 b           0 b           0 b           0 b          3300  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      28.946ms         1.28%      28.946ms       6.185us           0 b           0 b           0 b           0 b          4680  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     122.689ms         5.41%     122.689ms      14.001us           0 b           0 b           0 b           0 b          8763  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.096ms         0.18%       4.096ms       8.257us           0 b           0 b           0 b           0 b           496  
void at::native::batch_norm_backward_kernel<float, f...         0.00%       0.000us         0.00%       0.000us       0.000us      98.245ms         4.33%      98.245ms      31.368us           0 b           0 b           0 b           0 b          3132  
void cudnn::engines_precompiled::nchwToNhwcKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     238.179ms        10.51%     238.179ms      12.845us           0 b           0 b           0 b           0 b         18543  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      11.177ms         0.49%      11.177ms      90.135us           0 b           0 b           0 b           0 b           124  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       8.354ms         0.37%       8.354ms       1.730us           0 b           0 b           0 b           0 b          4830  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us     318.423ms        14.05%     318.423ms     141.900us           0 b           0 b           0 b           0 b          2244  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us       4.238ms         0.19%       4.238ms      34.175us           0 b           0 b           0 b           0 b           124  
sm86_xmma_wgrad_implicit_gemm_indexed_tf32f32_tf32f3...         0.00%       0.000us         0.00%       0.000us       0.000us       3.702ms         0.16%       3.702ms      44.071us           0 b           0 b           0 b           0 b            84  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      32.376ms         1.43%      32.376ms      88.944us           0 b           0 b           0 b           0 b           364  
void cudnn::cnn::wgrad_alg1_engine<float, float, 128...         0.00%       0.000us         0.00%       0.000us       0.000us      24.245ms         1.07%      24.245ms     288.626us           0 b           0 b           0 b           0 b            84  
void wgrad_alg0_engine<float, 128, 5, 5, 3, 3, 3, fa...         0.00%       0.000us         0.00%       0.000us       0.000us      22.521ms         0.99%      22.521ms     110.399us           0 b           0 b           0 b           0 b           204  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     262.686us         0.01%     262.686us       2.136us           0 b           0 b           0 b           0 b           123  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us       8.012ms         0.35%       8.012ms      16.519us           0 b           0 b           0 b           0 b           485  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      20.077ms         0.89%      20.077ms      82.623us           0 b           0 b           0 b           0 b           243  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us       3.844ms         0.17%       3.844ms      46.313us           0 b           0 b           0 b           0 b            83  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      55.995ms         2.47%      55.995ms       8.381us           0 b           0 b           0 b           0 b          6681  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     136.701us         0.01%     136.701us       3.334us           0 b           0 b           0 b           0 b            41  
void cask__5x_cudnn::computeOffsetsKernel<false, fal...         0.00%       0.000us         0.00%       0.000us       0.000us     441.721us         0.02%     441.721us       1.825us           0 b           0 b           0 b           0 b           242  
        _5x_cudnn_ampere_scudnn_128x32_relu_small_nn_v1         0.00%       0.000us         0.00%       0.000us       0.000us       1.863ms         0.08%       1.863ms      15.275us           0 b           0 b           0 b           0 b           122  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      39.577ms         1.75%      39.577ms      11.340us           0 b           0 b           0 b           0 b          3490  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.372ms         0.06%       1.372ms       2.811us           0 b           0 b           0 b           0 b           488  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us       3.333ms         0.15%       3.333ms      27.316us           0 b           0 b           0 b           0 b           122  
void at::native::batch_norm_collect_statistics_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us      36.763ms         1.62%      36.763ms      11.760us           0 b           0 b           0 b           0 b          3126  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.210ms         0.19%       4.210ms       1.347us           0 b           0 b           0 b           0 b          3126  
void at::native::batch_norm_transform_input_kernel<f...         0.00%       0.000us         0.00%       0.000us       0.000us      44.648ms         1.97%      44.648ms      14.283us           0 b           0 b           0 b           0 b          3126  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      64.426ms         2.84%      64.426ms     266.224us           0 b           0 b           0 b           0 b           242  
sm86_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      10.724ms         0.47%      10.724ms      87.904us           0 b           0 b           0 b           0 b           122  
sm86_xmma_fprop_implicit_gemm_indexed_tf32f32_tf32f3...         0.00%       0.000us         0.00%       0.000us       0.000us       6.514ms         0.29%       6.514ms      53.391us           0 b           0 b           0 b           0 b           122  
void nchwAddPaddingKernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     220.197us         0.01%     220.197us       1.805us           0 b           0 b           0 b           0 b           122  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     241.250us         0.01%     241.250us       1.977us           0 b           0 b           0 b           0 b           122  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     786.677us         0.03%     786.677us       3.894us           0 b           0 b           0 b           0 b           202  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     425.093us         0.02%     425.093us       1.320us           0 b           0 b           0 b           0 b           322  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       9.803ms         0.43%       9.803ms     160.700us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.628ms         0.29%       6.628ms     108.651us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       9.855ms         0.43%       9.855ms     161.560us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.692ms         0.30%       6.692ms     109.710us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.644ms         0.29%       6.644ms     108.913us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.629ms         0.29%       6.629ms     108.665us           0 b           0 b           0 b           0 b            61  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      12.716ms         0.56%      12.716ms     208.457us           0 b           0 b           0 b           0 b            61  
                                          aten::randint         0.01%     748.300us         0.03%       1.874ms      23.420us       0.000us         0.00%       0.000us       0.000us         640 b           0 b           0 b           0 b            80  
                                          aten::random_         0.01%     537.151us         0.01%     537.151us       6.714us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            80  
                                             aten::item         0.11%       6.487ms         0.13%       7.740ms       1.613us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4800  
                              aten::_local_scalar_dense         0.02%       1.254ms         0.02%       1.254ms       0.261us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4800  
                                             aten::rand         0.01%     370.472us         0.01%     658.572us      16.464us       0.000us         0.00%       0.000us       0.000us         160 b           0 b           0 b           0 b            40  
                                         aten::uniform_         0.00%     112.880us         0.00%     112.880us       2.822us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                               aten::lt         0.01%     673.024us         0.03%       1.572ms      39.292us       0.000us         0.00%       0.000us       0.000us          40 b        -120 b           0 b           0 b            40  
                                               aten::to         0.04%       2.661ms         0.21%      13.039ms       3.663us       0.000us         0.00%       1.720ms       0.483us      30.00 Mb           0 b      30.00 Mb           0 b          3560  
                                         aten::_to_copy         0.02%       1.270ms         0.17%      10.378ms      51.892us       0.000us         0.00%       1.720ms       8.599us      30.00 Mb           0 b      30.00 Mb           0 b           200  
                                            aten::copy_         0.96%      58.222ms         2.45%     148.833ms      16.576us     124.098ms         5.48%     124.098ms      13.821us           0 b           0 b           0 b           0 b          8979  
                                       aten::is_nonzero         0.00%     150.400us         0.01%     361.860us       4.523us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            80  
                                       aten::lift_fresh         0.00%     150.980us         0.00%     150.980us       0.944us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           160  
                                             aten::view         0.86%      52.455ms         0.86%      52.455ms       1.601us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         32760  
                                          aten::permute         0.01%     372.441us         0.01%     481.233us      12.031us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                       aten::as_strided         0.67%      40.989ms         0.67%      40.989ms       1.186us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         34560  
                                       aten::contiguous         0.00%     122.070us         0.09%       5.245ms     131.123us       0.000us         0.00%       0.000us       0.000us       7.50 Mb           0 b           0 b           0 b            40  
                                            aten::clone         0.17%      10.483ms         1.11%      67.211ms      29.235us       0.000us         0.00%      29.952ms      13.028us      37.50 Mb           0 b      11.57 Gb           0 b          2299  
                                       aten::empty_like         0.52%      31.731ms         1.93%     117.003ms      10.695us       0.000us         0.00%       0.000us       0.000us       7.50 Mb           0 b      52.36 Gb           0 b         10940  
                                               aten::eq         0.01%     445.191us         0.01%     832.961us      20.824us       0.000us         0.00%       0.000us       0.000us         120 b         -40 b           0 b           0 b            40  
                                              aten::any         0.01%     616.342us         0.01%     725.172us      18.129us       0.000us         0.00%       0.000us       0.000us          40 b          40 b           0 b           0 b            40  
                                            aten::fill_         0.45%      27.616ms         1.11%      67.499ms      14.362us      28.900ms         1.28%      28.900ms       6.149us           0 b           0 b           0 b           0 b          4700  
                                             aten::sub_         0.02%       1.052ms         0.02%       1.052ms      26.308us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                             aten::div_         0.02%       1.338ms         0.02%       1.338ms      33.450us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                        cudaEventRecord         0.43%      26.117ms         0.43%      26.117ms       1.446us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         18060  
                                    cudaStreamWaitEvent         0.08%       4.667ms         0.08%       4.667ms       1.161us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4020  
                                        cudaMemcpyAsync         1.46%      88.780ms         1.46%      88.780ms      10.159us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          8739  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us        4.564s       201.40%        4.564s      76.074ms           0 b           0 b           0 b           0 b            60  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.720ms         0.08%       1.720ms      42.997us           0 b           0 b           0 b           0 b            40  
                                  cudaStreamSynchronize         0.03%       1.830ms         0.03%       1.830ms      45.754us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                         cudaEventQuery         0.14%       8.369ms         0.14%       8.369ms       1.016us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          8238  
                                              aten::pad         0.11%       6.963ms         1.51%      91.852ms      38.272us       0.000us         0.00%      46.869ms      19.529us           0 b           0 b      11.04 Gb           0 b          2400  
                                 aten::reflection_pad2d         0.58%      35.298ms         1.40%      84.890ms      35.371us      46.851ms         2.07%      46.869ms      19.529us           0 b           0 b      11.04 Gb           0 b          2400  
                                       cudaLaunchKernel         8.55%     519.531ms         8.55%     519.531ms       7.007us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         74140  
void at::native::(anonymous namespace)::reflection_p...         0.00%       0.000us         0.00%       0.000us       0.000us      46.851ms         2.07%      46.851ms      19.521us           0 b           0 b           0 b           0 b          2400  
                                           aten::conv2d         0.44%      26.568ms         7.54%     458.023ms     141.365us       0.000us         0.00%     401.960ms     124.062us           0 b           0 b      12.91 Gb           0 b          3240  
                                        aten::unsqueeze         0.94%      57.062ms         1.12%      68.150ms       6.107us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         11160  
                                      aten::convolution         0.54%      32.765ms         6.79%     412.269ms     118.468us       0.000us         0.00%     445.985ms     128.157us           0 b           0 b      15.72 Gb           0 b          3480  
                                  cudaStreamIsCapturing         0.09%       5.327ms         0.09%       5.327ms       0.526us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10121  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 6.073s
Self CUDA time total: 2.266s

