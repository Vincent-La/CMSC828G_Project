batch_size: 16
Dataset loaded!
initialize network with normal
initialize network with normal
initialize network with normal
initialize network with normal
Start Profiling!
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.80%      76.495ms         0.91%      86.360ms       6.445us       0.000us         0.00%       0.000us       0.000us         160 b         160 b     102.02 Gb     102.02 Gb         13400  
                             aten::convolution_backward         1.91%     182.590ms         4.38%     417.844ms     165.811us        1.577s        39.21%        1.660s     658.723us           0 b           0 b      85.84 Gb      60.70 Gb          2520  
                                    aten::empty_strided         0.36%      34.255ms         0.44%      42.369ms       8.277us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      55.64 Gb      55.64 Gb          5119  
                                aten::cudnn_convolution         0.66%      62.950ms         1.15%     109.604ms      70.259us     338.121ms         8.41%     338.305ms     216.862us           0 b           0 b      31.02 Gb      31.02 Gb          1560  
                              aten::leaky_relu_backward         0.16%      14.859ms         0.29%      27.775ms      21.042us      74.962ms         1.86%      74.962ms      56.789us           0 b           0 b      31.01 Gb      31.01 Gb          1320  
                                              aten::cat         0.16%      15.308ms         0.23%      22.358ms      25.406us      50.611ms         1.26%      50.611ms      57.512us           0 b           0 b      29.21 Gb      29.21 Gb           880  
                               aten::threshold_backward         0.13%      12.038ms         0.22%      21.023ms      21.899us      70.278ms         1.75%      70.278ms      73.206us           0 b           0 b      28.74 Gb      28.74 Gb           960  
                      aten::cudnn_convolution_transpose         0.36%      34.793ms         0.66%      62.887ms      65.508us     599.931ms        14.92%     600.750ms     625.781us           0 b           0 b      15.78 Gb      15.78 Gb           960  
                                              aten::add         0.12%      11.269ms         0.19%      18.287ms      18.660us      37.444ms         0.93%      37.444ms      38.208us           0 b           0 b      14.37 Gb      14.37 Gb           980  
                                             aten::tanh         0.02%       2.062ms         0.03%       2.941ms      24.512us       1.557ms         0.04%       1.557ms      12.972us           0 b           0 b       1.41 Gb       1.41 Gb           120  
                                    aten::tanh_backward         0.01%       1.426ms         0.03%       2.659ms      22.160us       3.316ms         0.08%       3.316ms      27.633us           0 b           0 b       1.41 Gb       1.41 Gb           120  
                                              aten::mul         0.06%       5.917ms         0.10%       9.895ms      24.739us       2.818ms         0.07%       2.818ms       7.046us           0 b           0 b     960.16 Mb     960.16 Mb           400  
                                              aten::sub         0.01%       1.364ms         0.02%       2.225ms      27.815us       1.839ms         0.05%       1.839ms      22.987us           0 b           0 b     960.06 Mb     960.06 Mb            80  
                                          aten::resize_         0.01%     483.981us         0.01%     501.194us       2.506us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     960.00 Mb     960.00 Mb           200  
                                              aten::div         0.02%       1.764ms         0.03%       2.539ms      31.735us       1.212ms         0.03%       1.212ms      15.147us           0 b           0 b     960.00 Mb     960.00 Mb            80  
                                              aten::sgn         0.01%       1.010ms         0.02%       1.666ms      20.830us       1.653ms         0.04%       1.653ms      20.668us           0 b           0 b     960.00 Mb     960.00 Mb            80  
                                              aten::sum         0.47%      44.784ms         0.76%      72.752ms      31.359us      83.060ms         2.07%      83.060ms      35.802us           0 b           0 b       2.99 Mb       2.99 Mb          2320  
                                             aten::mean         0.04%       4.158ms         0.07%       6.309ms      31.547us       1.686ms         0.04%       1.686ms       8.429us           0 b           0 b      40.00 Kb      40.00 Kb           200  
void cudnn::engines_precompiled::nhwcToNchwKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     134.880ms         3.35%     134.880ms      26.535us           0 b           0 b           0 b           0 b          5083  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      84.214ms         2.09%      84.214ms      36.631us           0 b           0 b           0 b           0 b          2299  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     123.608ms         3.07%     123.608ms      36.132us           0 b           0 b           0 b           0 b          3421  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      12.300ms         0.31%      12.300ms       9.368us           0 b           0 b           0 b           0 b          1313  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     122.897ms         3.06%     122.897ms      25.293us           0 b           0 b           0 b           0 b          4859  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      72.645ms         1.81%      72.645ms      72.863us           0 b           0 b           0 b           0 b           997  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      77.994ms         1.94%      77.994ms      56.640us           0 b           0 b           0 b           0 b          1377  
void at::native::batch_norm_backward_kernel<float, f...         0.00%       0.000us         0.00%       0.000us       0.000us     152.577ms         3.79%     152.577ms      76.327us           0 b           0 b           0 b           0 b          1999  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      28.522ms         0.71%      28.522ms      32.708us           0 b           0 b           0 b           0 b           872  
void cudnn::engines_precompiled::nchwToNhwcKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     415.978ms        10.34%     415.978ms      33.098us           0 b           0 b           0 b           0 b         12568  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      20.036ms         0.50%      20.036ms      81.448us           0 b           0 b           0 b           0 b           246  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      49.456ms         1.23%      49.456ms     201.859us           0 b           0 b           0 b           0 b           245  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      86.528ms         2.15%      86.528ms      86.355us           0 b           0 b           0 b           0 b          1002  
enumerate(DataLoader)#_MultiProcessingDataLoaderIter...        53.48%        5.103s        53.48%        5.104s     255.179ms       0.000us         0.00%       0.000us       0.000us     480.00 Mb     480.00 Mb           0 b           0 b            20  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us     111.505ms         2.77%     111.505ms     226.635us           0 b           0 b           0 b           0 b           492  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      41.681ms         1.04%      41.681ms       9.250us           0 b           0 b           0 b           0 b          4506  
sm80_xmma_fprop_implicit_gemm_indexed_tf32f32_tf32f3...         0.00%       0.000us         0.00%       0.000us       0.000us     109.164ms         2.71%     109.164ms     177.791us           0 b           0 b           0 b           0 b           614  
_ZN17cutlass__5x_cudnn6KernelINS_4conv6kernel23Impli...         0.00%       0.000us         0.00%       0.000us       0.000us     117.351ms         2.92%     117.351ms     351.349us           0 b           0 b           0 b           0 b           334  
void cutlass__5x_cudnn::Kernel<cutlass__5x_cudnn::re...         0.00%       0.000us         0.00%       0.000us       0.000us      45.240ms         1.12%      45.240ms      40.177us           0 b           0 b           0 b           0 b          1126  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      96.803ms         2.41%      96.803ms     261.630us           0 b           0 b           0 b           0 b           370  
sm80_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      19.766ms         0.49%      19.766ms      54.153us           0 b           0 b           0 b           0 b           365  
_ZN17cutlass__5x_cudnn6KernelINS_4conv6kernel23Impli...         0.00%       0.000us         0.00%       0.000us       0.000us     210.612ms         5.24%     210.612ms     265.924us           0 b           0 b           0 b           0 b           792  
sm80_xmma_dgrad_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us       8.620ms         0.21%       8.620ms      35.182us           0 b           0 b           0 b           0 b           245  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.450ms         0.04%       1.450ms      11.599us           0 b           0 b           0 b           0 b           125  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us     116.373ms         2.89%     116.373ms     314.521us           0 b           0 b           0 b           0 b           370  
void cudnn::engines_precompiled::scalePackedTensor_k...         0.00%       0.000us         0.00%       0.000us       0.000us       1.543ms         0.04%       1.543ms       6.297us           0 b           0 b           0 b           0 b           245  
void cudnn::detail::dgrad2d_alg1_1<float, 0, 6, 7, 5...         0.00%       0.000us         0.00%       0.000us       0.000us     385.968ms         9.60%     385.968ms       1.575ms           0 b           0 b           0 b           0 b           245  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us       2.060ms         0.05%       2.060ms      10.196us           0 b           0 b           0 b           0 b           202  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      79.448ms         1.98%      79.448ms     243.707us           0 b           0 b           0 b           0 b           326  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us      37.676ms         0.94%      37.676ms     186.514us           0 b           0 b           0 b           0 b           202  
void wgrad_alg0_engine<float, 128, 5, 5, 3, 3, 3, fa...         0.00%       0.000us         0.00%       0.000us       0.000us     100.812ms         2.51%     100.812ms     342.899us           0 b           0 b           0 b           0 b           294  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      49.368ms         1.23%      49.368ms      14.640us           0 b           0 b           0 b           0 b          3372  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.414ms         0.08%       3.414ms      27.534us           0 b           0 b           0 b           0 b           124  
void cask__5x_cudnn::computeOffsetsKernel<false, fal...         0.00%       0.000us         0.00%       0.000us       0.000us       1.132ms         0.03%       1.132ms       3.075us           0 b           0 b           0 b           0 b           368  
       _5x_cudnn_ampere_scudnn_128x64_relu_medium_nn_v1         0.00%       0.000us         0.00%       0.000us       0.000us      55.594ms         1.38%      55.594ms     151.069us           0 b           0 b           0 b           0 b           368  
                                        cudaEventRecord         0.17%      16.039ms         0.17%      16.039ms       1.271us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         12620  
                                    cudaStreamWaitEvent         0.02%       2.371ms         0.02%       2.371ms       0.865us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2740  
                                               aten::to         0.02%       1.700ms        11.04%        1.054s     642.629us       0.000us         0.00%     220.080ms     134.195us           0 b           0 b     480.00 Mb           0 b          1640  
                                         aten::_to_copy         0.01%       1.031ms        11.03%        1.052s      26.305ms       0.000us         0.00%     220.080ms       5.502ms           0 b           0 b     480.00 Mb           0 b            40  
sm80_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us     217.299ms         5.40%     217.299ms     252.673us           0 b           0 b           0 b           0 b           860  
                                         cudaEventQuery         0.38%      36.161ms         0.38%      36.161ms       1.048us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         34499  
                                            aten::copy_         0.32%      30.064ms        11.83%        1.129s     203.839us     365.886ms         9.10%     365.886ms      66.056us           0 b           0 b           0 b           0 b          5539  
                                        cudaMemcpyAsync        11.29%        1.077s        11.29%        1.077s     229.224us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4699  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     812.084us         0.02%     812.084us       2.491us           0 b           0 b           0 b           0 b           326  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.224ms         0.03%       1.224ms      15.107us           0 b           0 b           0 b           0 b            81  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.674ms         0.04%       1.674ms      20.665us           0 b           0 b           0 b           0 b            81  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.041ms         0.05%       2.041ms      25.203us           0 b           0 b           0 b           0 b            81  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      21.986ms         0.55%      21.986ms     149.565us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.438ms         0.38%      15.438ms     105.021us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      22.491ms         0.56%      22.491ms     152.998us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.615ms         0.39%      15.615ms     106.223us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.927ms         0.40%      15.927ms     108.345us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.180ms         0.38%      15.180ms     103.266us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      29.877ms         0.74%      29.877ms     203.248us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      50.645ms         1.26%      50.645ms      57.421us           0 b           0 b           0 b           0 b           882  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      46.372ms         1.15%      46.372ms      34.710us           0 b           0 b           0 b           0 b          1336  
void at::native::batch_norm_collect_statistics_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     138.621ms         3.45%     138.621ms      71.750us           0 b           0 b           0 b           0 b          1932  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.944ms         0.12%       4.944ms       2.559us           0 b           0 b           0 b           0 b          1932  
void at::native::batch_norm_transform_input_kernel<f...         0.00%       0.000us         0.00%       0.000us       0.000us      55.960ms         1.39%      55.960ms      28.965us           0 b           0 b           0 b           0 b          1932  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us       4.353ms         0.11%       4.353ms      17.551us           0 b           0 b           0 b           0 b           248  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      29.163ms         0.73%      29.163ms     235.187us           0 b           0 b           0 b           0 b           124  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     362.558us         0.01%     362.558us       2.924us           0 b           0 b           0 b           0 b           124  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.598ms         0.04%       1.598ms       7.832us           0 b           0 b           0 b           0 b           204  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     489.055us         0.01%     489.055us       3.944us           0 b           0 b           0 b           0 b           124  
sm80_xmma_dgrad_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      85.583ms         2.13%      85.583ms     690.184us           0 b           0 b           0 b           0 b           124  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us        4.512s       112.19%        4.512s      75.196ms           0 b           0 b           0 b           0 b            60  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     220.080ms         5.47%     220.080ms       5.502ms           0 b           0 b           0 b           0 b            40  
                                  cudaStreamSynchronize         0.15%      14.088ms         0.15%      14.088ms     352.208us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                           aten::conv2d         0.06%       6.167ms         1.88%     179.868ms     115.300us       0.000us         0.00%     392.529ms     251.621us           0 b           0 b      31.02 Gb           0 b          1560  
                                      aten::convolution         0.24%      23.117ms         2.88%     274.471ms     108.917us       0.000us         0.00%        1.023s     405.873us           0 b           0 b      46.80 Gb           0 b          2520  
                                     aten::_convolution         0.31%      29.910ms         2.63%     251.354ms      99.744us       0.000us         0.00%        1.023s     405.873us           0 b           0 b      46.80 Gb           0 b          2520  
                                  cudaStreamIsCapturing         0.03%       3.230ms         0.03%       3.230ms       0.446us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7241  
                                  cudaStreamGetPriority         0.04%       3.672ms         0.04%       3.672ms       0.510us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7200  
                       cudaDeviceGetStreamPriorityRange         0.03%       2.619ms         0.03%       2.619ms       0.364us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7200  
                                       cudaLaunchKernel         3.47%     331.456ms         3.47%     331.456ms       6.512us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         50900  
                                    cudaPeekAtLastError         0.01%       1.430ms         0.01%       1.430ms       0.107us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         13360  
                                        cudaMemsetAsync         0.32%      30.780ms         0.32%      30.780ms       6.521us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4720  
                                          aten::reshape         0.24%      23.163ms         0.70%      67.006ms       5.170us       0.000us         0.00%      27.593ms       2.129us           0 b           0 b      14.37 Gb           0 b         12960  
                                             aten::view         0.34%      32.112ms         0.34%      32.112ms       1.622us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         19800  
                                             aten::add_         0.45%      42.773ms         0.80%      75.871ms      10.538us     128.697ms         3.20%     128.731ms      17.879us           0 b           0 b           0 b           0 b          7200  
                                      aten::leaky_relu_         0.24%      22.672ms         0.34%      32.654ms      24.738us      45.576ms         1.13%      45.576ms      34.527us           0 b           0 b           0 b           0 b          1320  
                                   cudaFuncSetAttribute         0.07%       6.258ms         0.07%       6.258ms       0.738us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          8480  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.542s
Self CUDA time total: 4.021s

