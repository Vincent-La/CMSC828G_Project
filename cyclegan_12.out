batch_size: 12
Dataset loaded!
initialize network with normal
initialize network with normal
initialize network with normal
initialize network with normal
Start Profiling!
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         2.00%      79.667ms         2.18%      86.908ms       6.486us       0.000us         0.00%       0.000us       0.000us         160 b         160 b      83.08 Gb      83.08 Gb         13400  
                             aten::convolution_backward         4.47%     177.730ms        10.06%     400.488ms     158.924us        1.230s        39.73%        1.301s     516.458us           0 b           0 b      70.85 Gb      45.59 Gb          2520  
                                    aten::empty_strided         0.79%      31.583ms         0.91%      36.107ms       7.217us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      44.00 Gb      44.00 Gb          5003  
                                aten::cudnn_convolution         1.63%      64.710ms         2.71%     107.860ms      69.141us     264.763ms         8.55%     264.932ms     169.828us           0 b           0 b      23.30 Gb      23.30 Gb          1560  
                              aten::leaky_relu_backward         0.37%      14.616ms         0.65%      25.689ms      19.462us      55.853ms         1.80%      55.853ms      42.313us           0 b           0 b      23.28 Gb      23.28 Gb          1320  
                                              aten::cat         0.40%      15.914ms         0.57%      22.697ms      25.792us      37.023ms         1.20%      37.023ms      42.071us           0 b           0 b      21.94 Gb      21.94 Gb           880  
                               aten::threshold_backward         0.30%      12.070ms         0.52%      20.706ms      21.569us      53.123ms         1.72%      53.123ms      55.337us           0 b           0 b      21.60 Gb      21.60 Gb           960  
                      aten::cudnn_convolution_transpose         0.91%      36.383ms         1.62%      64.466ms      67.152us     456.865ms        14.76%     456.865ms     475.901us           0 b           0 b      11.87 Gb      11.87 Gb           960  
                                              aten::add         0.28%      11.335ms         0.46%      18.389ms      18.764us      30.833ms         1.00%      30.833ms      31.462us           0 b           0 b      10.82 Gb      10.82 Gb           980  
                                    aten::tanh_backward         0.04%       1.442ms         0.07%       2.672ms      22.265us       2.433ms         0.08%       2.433ms      20.274us           0 b           0 b       1.06 Gb       1.06 Gb           120  
                                             aten::tanh         0.05%       2.105ms         0.08%       3.088ms      25.733us     995.799us         0.03%     995.799us       8.298us           0 b           0 b       1.06 Gb       1.06 Gb           120  
                                              aten::sub         0.03%       1.363ms         0.05%       2.178ms      27.221us       1.364ms         0.04%       1.364ms      17.049us           0 b           0 b     739.44 Mb     739.44 Mb            80  
                                          aten::resize_         0.01%     521.728us         0.01%     521.728us       2.609us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     736.58 Mb     736.58 Mb           200  
                                              aten::div         0.04%       1.740ms         0.06%       2.501ms      31.256us     863.481us         0.03%     863.481us      10.794us           0 b           0 b     731.72 Mb     731.72 Mb            80  
                                              aten::sgn         0.02%     957.721us         0.04%       1.601ms      20.016us       1.127ms         0.04%       1.127ms      14.087us           0 b           0 b     728.77 Mb     728.77 Mb            80  
                                              aten::mul         0.14%       5.587ms         0.23%       9.263ms      23.158us       1.740ms         0.06%       1.740ms       4.349us           0 b           0 b     724.59 Mb     724.59 Mb           400  
                                           Buffer Flush         0.04%       1.564ms         0.04%       1.575ms     105.014us     312.667us         0.01%     312.667us      20.844us           0 b           0 b      24.99 Mb      24.99 Mb            15  
                                              aten::sum         1.12%      44.532ms         1.72%      68.497ms      29.525us      71.569ms         2.31%      71.569ms      30.849us           0 b           0 b       2.99 Mb       2.99 Mb          2320  
                                             aten::mean         0.09%       3.779ms         0.15%       6.013ms      30.065us       1.535ms         0.05%       1.535ms       7.675us           0 b           0 b      40.00 Kb      40.00 Kb           200  
void cudnn::engines_precompiled::nhwcToNchwKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     105.871ms         3.42%     105.871ms      22.126us           0 b           0 b           0 b           0 b          4785  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      71.195ms         2.30%      71.195ms      31.433us           0 b           0 b           0 b           0 b          2265  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      95.004ms         3.07%      95.004ms      27.901us           0 b           0 b           0 b           0 b          3405  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.374ms         0.30%       9.374ms       7.217us           0 b           0 b           0 b           0 b          1299  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      89.433ms         2.89%      89.433ms      19.097us           0 b           0 b           0 b           0 b          4683  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      57.627ms         1.86%      57.627ms      42.342us           0 b           0 b           0 b           0 b          1361  
void at::native::batch_norm_backward_kernel<float, f...         0.00%       0.000us         0.00%       0.000us       0.000us     114.847ms         3.71%     114.847ms      58.328us           0 b           0 b           0 b           0 b          1969  
void cudnn::engines_precompiled::nchwToNhwcKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     340.700ms        11.01%     340.700ms      27.385us           0 b           0 b           0 b           0 b         12441  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      57.299ms         1.85%      57.299ms      58.290us           0 b           0 b           0 b           0 b           983  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      37.833ms         1.22%      37.833ms     103.088us           0 b           0 b           0 b           0 b           367  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      53.968ms         1.74%      53.968ms      55.125us           0 b           0 b           0 b           0 b           979  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      30.004ms         0.97%      30.004ms       7.623us           0 b           0 b           0 b           0 b          3936  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      22.947ms         0.74%      22.947ms      26.807us           0 b           0 b           0 b           0 b           856  
_ZN17cutlass__5x_cudnn6KernelINS_4conv6kernel23Impli...         0.00%       0.000us         0.00%       0.000us       0.000us      81.384ms         2.63%      81.384ms     246.619us           0 b           0 b           0 b           0 b           330  
void cutlass__5x_cudnn::Kernel<cutlass__5x_cudnn::re...         0.00%       0.000us         0.00%       0.000us       0.000us      29.481ms         0.95%      29.481ms      32.612us           0 b           0 b           0 b           0 b           904  
enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         0.77%      30.697ms         0.78%      31.030ms       1.552ms       0.000us         0.00%       0.000us       0.000us     360.00 Mb     360.00 Mb           0 b           0 b            20  
sm80_xmma_fprop_implicit_gemm_indexed_tf32f32_tf32f3...         0.00%       0.000us         0.00%       0.000us       0.000us      41.142ms         1.33%      41.142ms     167.925us           0 b           0 b           0 b           0 b           245  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      62.978ms         2.03%      62.978ms     171.136us           0 b           0 b           0 b           0 b           368  
_ZN17cutlass__5x_cudnn6KernelINS_4conv6kernel23Impli...         0.00%       0.000us         0.00%       0.000us       0.000us     126.898ms         4.10%     126.898ms     221.077us           0 b           0 b           0 b           0 b           574  
sm80_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      29.119ms         0.94%      29.119ms      80.217us           0 b           0 b           0 b           0 b           363  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      89.541ms         2.89%      89.541ms     243.319us           0 b           0 b           0 b           0 b           368  
sm80_xmma_dgrad_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us       9.390ms         0.30%       9.390ms      38.644us           0 b           0 b           0 b           0 b           243  
sm80_xmma_wgrad_implicit_gemm_indexed_tf32f32_tf32f3...         0.00%       0.000us         0.00%       0.000us       0.000us      49.252ms         1.59%      49.252ms     236.787us           0 b           0 b           0 b           0 b           208  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.219ms         0.04%       1.219ms       9.907us           0 b           0 b           0 b           0 b           123  
                                             aten::set_         0.00%     198.809us         0.00%     198.809us       4.970us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
void cudnn::engines_precompiled::scalePackedTensor_k...         0.00%       0.000us         0.00%       0.000us       0.000us     670.270us         0.02%     670.270us       2.758us           0 b           0 b           0 b           0 b           243  
void cudnn::detail::dgrad2d_alg1_1<float, 0, 6, 7, 5...         0.00%       0.000us         0.00%       0.000us       0.000us     301.993ms         9.76%     301.993ms       1.243ms           0 b           0 b           0 b           0 b           243  
void wgrad_alg0_engine<float, 128, 5, 5, 3, 3, 3, fa...         0.00%       0.000us         0.00%       0.000us       0.000us      80.208ms         2.59%      80.208ms     274.685us           0 b           0 b           0 b           0 b           292  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      52.024ms         1.68%      52.024ms     143.316us           0 b           0 b           0 b           0 b           363  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      49.306ms         1.59%      49.306ms      14.626us           0 b           0 b           0 b           0 b          3371  
                                        cudaEventRecord         0.42%      16.740ms         0.42%      16.740ms       1.326us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         12620  
                                    cudaStreamWaitEvent         0.06%       2.430ms         0.06%       2.430ms       0.887us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2740  
                                               aten::to         0.03%       1.169ms        16.50%     656.385ms     400.235us       0.000us         0.00%     150.333ms      91.667us           0 b           0 b     360.00 Mb           0 b          1640  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.466ms         0.08%       2.466ms      20.216us           0 b           0 b           0 b           0 b           122  
                                         aten::_to_copy         0.01%     500.323us        16.47%     655.216ms      16.380ms       0.000us         0.00%     150.333ms       3.758ms           0 b           0 b     360.00 Mb           0 b            40  
                                         cudaEventQuery         0.64%      25.440ms         0.64%      25.440ms       1.197us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         21247  
void cask__5x_cudnn::computeOffsetsKernel<false, fal...         0.00%       0.000us         0.00%       0.000us       0.000us       1.073ms         0.03%       1.073ms       2.933us           0 b           0 b           0 b           0 b           366  
       _5x_cudnn_ampere_scudnn_128x64_relu_medium_nn_v1         0.00%       0.000us         0.00%       0.000us       0.000us      45.267ms         1.46%      45.267ms     123.680us           0 b           0 b           0 b           0 b           366  
                                            aten::copy_         0.73%      29.024ms        18.42%     733.164ms     135.195us     259.728ms         8.39%     259.728ms      47.894us           0 b           0 b           0 b           0 b          5423  
                                        cudaMemcpyAsync        17.17%     683.356ms        17.17%     683.356ms     149.107us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4583  
sm80_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us     211.618ms         6.84%     211.618ms     192.731us           0 b           0 b           0 b           0 b          1098  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      43.759ms         1.41%      43.759ms     120.882us           0 b           0 b           0 b           0 b           362  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us       1.956ms         0.06%       1.956ms       9.731us           0 b           0 b           0 b           0 b           201  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us      56.792ms         1.83%      56.792ms     282.546us           0 b           0 b           0 b           0 b           201  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us      27.679ms         0.89%      27.679ms     137.708us           0 b           0 b           0 b           0 b           201  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      21.938ms         0.71%      21.938ms     149.235us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.460ms         0.50%      15.460ms     105.173us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      22.587ms         0.73%      22.587ms     153.652us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.618ms         0.50%      15.618ms     106.242us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.948ms         0.52%      15.948ms     108.487us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      15.150ms         0.49%      15.150ms     103.065us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us      29.796ms         0.96%      29.796ms     202.691us           0 b           0 b           0 b           0 b           147  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      37.050ms         1.20%      37.050ms      42.007us           0 b           0 b           0 b           0 b           882  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      32.163ms         1.04%      32.163ms      24.074us           0 b           0 b           0 b           0 b          1336  
void at::native::batch_norm_collect_statistics_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     101.100ms         3.27%     101.100ms      52.329us           0 b           0 b           0 b           0 b          1932  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.467ms         0.14%       4.467ms       2.312us           0 b           0 b           0 b           0 b          1932  
void at::native::batch_norm_transform_input_kernel<f...         0.00%       0.000us         0.00%       0.000us       0.000us      39.884ms         1.29%      39.884ms      20.644us           0 b           0 b           0 b           0 b          1932  
void tensorTransformGeneric<float, float, float, tru...         0.00%       0.000us         0.00%       0.000us       0.000us       4.341ms         0.14%       4.341ms      17.503us           0 b           0 b           0 b           0 b           248  
sm80_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      14.589ms         0.47%      14.589ms     117.652us           0 b           0 b           0 b           0 b           124  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     361.433us         0.01%     361.433us       2.915us           0 b           0 b           0 b           0 b           124  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.448ms         0.05%       1.448ms       7.100us           0 b           0 b           0 b           0 b           204  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     716.144us         0.02%     716.144us       2.210us           0 b           0 b           0 b           0 b           324  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     431.259us         0.01%     431.259us       3.478us           0 b           0 b           0 b           0 b           124  
void cutlass__5x_cudnn::Kernel<cutlass_tensorop_s168...         0.00%       0.000us         0.00%       0.000us       0.000us       4.711ms         0.15%       4.711ms      37.988us           0 b           0 b           0 b           0 b           124  
sm80_xmma_dgrad_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us      50.326ms         1.63%      50.326ms     405.857us           0 b           0 b           0 b           0 b           124  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us        3.396s       109.71%        3.396s      56.597ms           0 b           0 b           0 b           0 b            60  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     150.333ms         4.86%     150.333ms       3.758ms           0 b           0 b           0 b           0 b            40  
                                  cudaStreamSynchronize         0.32%      12.836ms         0.32%      12.836ms     320.893us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            40  
                                           aten::conv2d         0.14%       5.693ms         4.48%     178.449ms     114.390us       0.000us         0.00%     304.764ms     195.362us           0 b           0 b      23.30 Gb           0 b          1560  
                                      aten::convolution         0.60%      23.875ms         6.90%     274.425ms     108.899us       0.000us         0.00%     784.633ms     311.362us           0 b           0 b      35.16 Gb           0 b          2520  
                                     aten::_convolution         0.74%      29.350ms         6.30%     250.549ms      99.424us       0.000us         0.00%     784.633ms     311.362us           0 b           0 b      35.16 Gb           0 b          2520  
                                  cudaStreamIsCapturing         0.08%       3.292ms         0.08%       3.292ms       0.455us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7242  
                                  cudaStreamGetPriority         0.07%       2.719ms         0.07%       2.719ms       0.378us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7200  
                       cudaDeviceGetStreamPriorityRange         0.07%       2.631ms         0.07%       2.631ms       0.365us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7200  
                                       cudaLaunchKernel         8.10%     322.366ms         8.10%     322.366ms       6.414us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         50260  
                                    cudaPeekAtLastError         0.03%       1.374ms         0.03%       1.374ms       0.103us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         13360  
                                        cudaMemsetAsync         0.66%      26.269ms         0.66%      26.269ms       6.255us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4200  
                                          aten::reshape         0.57%      22.523ms         1.68%      66.896ms       5.162us       0.000us         0.00%      22.613ms       1.745us           0 b           0 b      10.82 Gb           0 b         12960  
                                             aten::view         0.81%      32.396ms         0.81%      32.396ms       1.636us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         19800  
                                             aten::add_         1.05%      41.968ms         1.86%      74.172ms      10.302us     108.267ms         3.50%     108.267ms      15.037us           0 b           0 b           0 b           0 b          7200  
                                      aten::leaky_relu_         0.60%      23.973ms         0.86%      34.302ms      25.986us      31.625ms         1.02%      31.625ms      23.959us           0 b           0 b           0 b           0 b          1320  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 3.979s
Self CUDA time total: 3.095s

